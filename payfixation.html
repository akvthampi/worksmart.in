<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comparison of Options for Pay Fixation on Promotion/MACP</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0a192f 0%, #0d1b2a 100%);
            color: #e0e0e0;
            line-height: 1.4;
            padding: 15px 25px;
            min-height: 100vh;
        }
        
        .main-header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(13, 27, 42, 0.7);
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(0, 150, 255, 0.2);
            border: 1px solid rgba(100, 150, 255, 0.1);
        }
        
        .main-header h1 {
            color: #64b5f6;
            margin-bottom: 8px;
            font-size: 1.6rem;
            text-shadow: 0 0 10px rgba(100, 181, 246, 0.7);
            letter-spacing: 1px;
        }
        
        .main-header .subtitle {
            color: #90caf9;
            font-size: 1.1rem;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: rgba(13, 27, 42, 0.7);
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(0, 150, 255, 0.2);
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(100, 150, 255, 0.1);
            display: flex;
            gap: 20px;
        }
        
        .input-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-width: 300px;
        }
        
        .results-section {
            flex: 2;
            display: flex;
            flex-direction: column;
        }
        
        .input-group {
            margin-bottom: 12px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #90caf9;
            font-weight: 600;
            font-size: 14px;
        }
        
        .input-group input, .input-group select {
            width: 100%;
            padding: 10px;
            background-color: rgba(20, 30, 48, 0.8);
            border: 2px solid rgba(100, 150, 255, 0.3);
            border-radius: 8px;
            font-size: 14px;
            color: #e0e0e0;
            transition: all 0.3s ease;
        }
        
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #64b5f6;
            box-shadow: 0 0 15px rgba(100, 181, 246, 0.5);
        }
        
        .calculate-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #64b5f6, #1976d2);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 8px;
            margin-bottom: 15px;
            border: 2px solid rgba(100, 150, 255, 0.3);
        }
        
        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(100, 181, 246, 0.4);
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: rgba(20, 30, 48, 0.8);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 15px rgba(0, 150, 255, 0.3);
        }
        
        .comparison-table th {
            background: linear-gradient(135deg, #1976d2, #64b5f6);
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: 600;
        }
        
        .comparison-table td {
            padding: 12px;
            border-bottom: 1px solid rgba(100, 150, 255, 0.2);
            text-align: center;
        }
        
        .comparison-table tr:nth-child(even) {
            background: rgba(30, 40, 60, 0.5);
        }
        
        .comparison-table tr:hover {
            background: rgba(100, 181, 246, 0.1);
        }
        
        .option-1-cell {
            background: rgba(76, 175, 80, 0.1);
            border-left: 3px solid #4caf50;
        }
        
        .option-2-cell {
            background: rgba(255, 152, 0, 0.1);
            border-left: 3px solid #ff9800;
        }
        
        .highlight-cell {
            font-weight: bold;
            color: #ffeb3b;
        }
        
        .date-cell {
            color: #90caf9;
        }
        
        .amount-cell {
            font-weight: bold;
        }
        
        .recommendation-row {
            background: rgba(156, 39, 176, 0.2) !important;
            font-weight: bold;
        }
        
        .info-box {
            background: rgba(100, 181, 246, 0.1);
            border-left: 4px solid #64b5f6;
            padding: 12px;
            margin: 12px 0;
            border-radius: 0 8px 8px 0;
            font-size: 13px;
        }
        
        .fixation-rule {
            background: rgba(255, 193, 7, 0.1);
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 12px 0;
            border-radius: 0 8px 8px 0;
            font-size: 13px;
        }
        
        .error-message {
            color: #f44336;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }
        
        .no-results {
            text-align: center;
            padding: 40px;
            color: #90caf9;
            font-style: italic;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @media (max-width: 1024px) {
            .container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="main-header">
        <h1>Comparison of Options for Pay Fixation on Promotion/MACP</h1>
        <p class="subtitle">Developed by Anil Kumar V.T. | For information only, recheck with relevant rules before submitting option.</p>
    </div>

    <div class="container">
        <div class="input-section">
            <div class="input-group">
                <label for="presentBasicPay">Present Basic Pay (₹)</label>
                <input type="number" id="presentBasicPay" placeholder="Enter basic pay" min="0" value="34300">
                <div class="error-message" id="basicPayError">Please enter a valid basic pay</div>
            </div>
            
            <div class="input-group">
                <label for="presentLevel">Present Pay Level</label>
                <select id="presentLevel">
                    <option value="">Select Present Level</option>
                    <option value="1">Level 1</option>
                    <option value="2">Level 2</option>
                    <option value="3">Level 3</option>
                    <option value="4" selected>Level 4</option>
                    <option value="5">Level 5</option>
                    <option value="6">Level 6</option>
                    <option value="7">Level 7</option>
                    <option value="8">Level 8</option>
                    <option value="9">Level 9</option>
                    <option value="10">Level 10</option>
                    <option value="11">Level 11</option>
                    <option value="12">Level 12</option>
                    <option value="13">Level 13</option>
                    <option value="13.5">Level 13A</option>
                    <option value="14">Level 14</option>
                </select>
                <div class="error-message" id="presentLevelError">Please select present level</div>
            </div>
            
            <div class="input-group">
                <label for="promotedLevel">Promoted/MACP Level</label>
                <select id="promotedLevel">
                    <option value="">Select Promoted Level</option>
                    <option value="1">Level 1</option>
                    <option value="2">Level 2</option>
                    <option value="3">Level 3</option>
                    <option value="4">Level 4</option>
                    <option value="5" selected>Level 5</option>
                    <option value="6">Level 6</option>
                    <option value="7">Level 7</option>
                    <option value="8">Level 8</option>
                    <option value="9">Level 9</option>
                    <option value="10">Level 10</option>
                    <option value="11">Level 11</option>
                    <option value="12">Level 12</option>
                    <option value="13">Level 13</option>
                    <option value="13.5">Level 13A</option>
                    <option value="14">Level 14</option>
                </select>
                <div class="error-message" id="promotedLevelError">Please select promoted level</div>
            </div>
            
            <div class="input-group">
                <label for="promotionDate">Date of Promotion/MACP</label>
                <input type="date" id="promotionDate" value="2024-12-31">
                <div class="error-message" id="promotionDateError">Please select promotion date</div>
            </div>
            
            <div class="input-group">
                <label for="nextIncrementDate">Date of Next Increment in Present Level</label>
                <input type="date" id="nextIncrementDate" value="2025-07-01">
                <div class="error-message" id="incrementDateError">Please select valid increment date (1st Jan or 1st Jul)</div>
            </div>
            
            <button class="calculate-btn" onclick="calculateFixation()">
                Calculate Pay Fixation Options
            </button>
            
            <div class="info-box">
                <p><strong>Option 1:</strong> Fixation from date of promotion/MACP</p>
                <p>• One increment in lower grade + fixation in higher grade</p>
                <p>• Next increment after 6 months from promotion</p>
            </div>
            
            <div class="fixation-rule">
                <p><strong>Option 2:</strong> Fixation from date of increment</p>
                <p>• Phase I: Interim fixation till DNI</p>
                <p>• Phase II: Re-fixation with two increments on DNI</p>
                <p>• Next increment after 6 months from final fixation</p>
            </div>

            <div class="info-box">
                <p><strong>Exception 1 : </strong> In case of promotion to a level in which minimum basic pay is higher than existing basic pay + 2 increments, Option 1 is better.</p>
                <p><strong>Exception 2 : </strong> If promotion happens on date of increment, there is only one option - employee gets two increments in existing level on promotion and gets next increment after six months</p>
               
            </div>
        </div>

        <div class="results-section">
            <div id="resultsContainer">
                <div class="no-results">
                    Enter details and click "Calculate Pay Fixation Options" to see comparison table
                </div>
            </div>
        </div>
    </div>

    <script>
        // 7th CPC Pay Matrix Data - Complete with 40 cells for each level
        const payMatrix = {
            1: [18000, 18500, 19100, 19700, 20300, 20900, 21500, 22100, 22800, 23500, 
                24200, 24900, 25600, 26400, 27200, 28000, 28800, 29700, 30600, 31500,
                32400, 33400, 34400, 35400, 36500, 37600, 38700, 39900, 41100, 42300,
                43600, 44900, 46200, 47600, 49000, 50500, 52000, 53600, 55200, 56900],
            
            2: [19900, 20500, 21100, 21700, 22400, 23100, 23800, 24500, 25200, 26000,
                26800, 27600, 28400, 29300, 30200, 31100, 32000, 33000, 34000, 35000,
                36100, 37200, 38300, 39400, 40600, 41800, 43100, 44400, 45700, 47100,
                48500, 50000, 51500, 53000, 54600, 56200, 57900, 59600, 61400, 63200],
            
            3: [21700, 22400, 23100, 23800, 24500, 25200, 26000, 26800, 27600, 28400,
                29300, 30200, 31100, 32000, 33000, 34000, 35000, 36100, 37200, 38300,
                39400, 40600, 41800, 43100, 44400, 45700, 47100, 48500, 50000, 51500,
                53000, 54600, 56200, 57900, 59600, 61400, 63200, 65100, 67100, 69100],
            
            4: [25500, 26300, 27100, 27900, 28700, 29600, 30500, 31400, 32300, 33300,
                34300, 35300, 36400, 37500, 38600, 39800, 41000, 42200, 43500, 44800,
                46100, 47500, 48900, 50400, 51900, 53500, 55100, 56800, 58500, 60300,
                62100, 64000, 65900, 67900, 69900, 72000, 74200, 76400, 78700, 81100],
            
            5: [29200, 30100, 31000, 31900, 32900, 33900, 34900, 35900, 37000, 38100,
                39200, 40400, 41600, 42800, 44100, 45400, 46800, 48200, 49600, 51100,
                52600, 54200, 55800, 57500, 59200, 61000, 62800, 64700, 66600, 68600,
                70700, 72800, 75000, 77300, 79600, 82000, 84500, 87000, 89600, 92300],
            
            6: [35400, 36500, 37600, 38700, 39900, 41100, 42300, 43600, 44900, 46200,
                47600, 49000, 50500, 52000, 53600, 55200, 56900, 58600, 60400, 62200,
                64100, 66000, 68000, 70000, 72100, 74300, 76500, 78800, 81200, 83600,
                86100, 88700, 91400, 94100, 96900, 99800, 102800, 105900, 109100, 112400],
            
            7: [44900, 46200, 47600, 49000, 50500, 52000, 53600, 55200, 56900, 58600,
                60400, 62200, 64100, 66000, 68000, 70000, 72100, 74300, 76500, 78800,
                81200, 83600, 86100, 88700, 91400, 94100, 96900, 99800, 102800, 105900,
                109100, 112400, 115800, 119300, 122900, 126600, 130400, 134300, 138300, 142400],
            
            8: [47600, 49000, 50500, 52000, 53600, 55200, 56900, 58600, 60400, 62200,
                64100, 66000, 68000, 70000, 72100, 74300, 76500, 78800, 81200, 83600,
                86100, 88700, 91400, 94100, 96900, 99800, 102800, 105900, 109100, 112400,
                115800, 119300, 122900, 126600, 130400, 134300, 138300, 142400, 146700, 151100],
            
            9: [53100, 54700, 56300, 58000, 59700, 61500, 63300, 65200, 67200, 69200,
                71300, 73400, 75600, 77900, 80200, 82600, 85100, 87700, 90300, 93000,
                95800, 98700, 101700, 104800, 107900, 111100, 114400, 117800, 121300, 124900,
                128600, 132500, 136500, 140600, 144800, 149100, 153600, 158200, 162900, 167800],
            
            10: [56100, 57800, 59500, 61300, 63100, 65000, 67000, 69000, 71100, 73200,
                 75400, 77700, 80000, 82400, 84900, 87400, 90000, 92700, 95500, 98400,
                 101400, 104400, 107500, 110700, 114000, 117400, 120900, 124500, 128200, 132000,
                 136000, 140100, 144300, 148600, 153100, 157700, 162400, 167300, 172300, 177500],
            
            11: [67700, 69700, 71800, 74000, 76200, 78500, 80900, 83300, 85800, 88400,
                 91100, 93800, 96600, 99500, 102500, 105600, 108800, 112100, 115500, 119000,
                 122600, 126300, 130100, 134000, 138000, 142100, 146400, 150800, 155300, 160000,
                 164800, 169700, 174800, 180000, 185400, 191000, 196700, 202600, 208700, 215000],
            
            12: [78800, 81200, 83600, 86100, 88700, 91400, 94100, 96900, 99800, 102800,
                 105900, 109100, 112400, 115800, 119300, 122900, 126600, 130400, 134300, 138300,
                 142400, 146700, 151100, 155600, 160300, 165100, 170100, 175200, 180500, 185900,
                 191500, 197200, 203100, 209200, 215500, 222000, 228700, 235600, 242700, 250000],
            
            13: [123100, 126800, 130600, 134500, 138500, 142700, 147000, 151400, 155900, 160600,
                 165400, 170400, 175500, 180800, 186200, 191800, 197600, 203500, 209600, 215900,
                 222400, 229100, 236000, 243100, 250400, 257900, 265600, 273500, 281600, 290000,
                 298600, 307500, 316600, 326000, 335600, 345500, 355600, 366000, 376600, 387500],
            
            13.5: [131100, 135000, 139100, 143300, 147600, 152000, 156600, 161300, 166100, 171100,
                   176200, 181500, 186900, 192500, 198300, 204200, 210300, 216600, 223100, 229800,
                   236700, 243800, 251100, 258600, 266300, 274200, 282300, 290600, 299100, 307800,
                   316700, 325800, 335100, 344600, 354300, 364200, 374300, 384600, 395100, 405800],
            
            14: [144200, 148500, 153000, 157600, 162300, 167200, 172200, 177400, 182700, 188200,
                 193800, 199600, 205600, 211800, 218200, 224800, 231600, 238600, 245800, 253200,
                 260800, 268600, 276600, 284800, 293200, 301800, 310600, 319600, 328800, 338200,
                 347800, 357600, 367600, 377800, 388200, 398800, 409600, 420600, 431800, 443200]
        };

        // DOM Elements
        const presentBasicPayInput = document.getElementById('presentBasicPay');
        const presentLevelSelect = document.getElementById('presentLevel');
        const promotedLevelSelect = document.getElementById('promotedLevel');
        const promotionDateInput = document.getElementById('promotionDate');
        const nextIncrementDateInput = document.getElementById('nextIncrementDate');
        const resultsContainer = document.getElementById('resultsContainer');

        // Safely add months to a date (avoids clamping issues)
        function addMonths(date, months) {
            const d = new Date(date);
            const newMonth = d.getMonth() + months;
            const newYear = d.getFullYear() + Math.floor(newMonth / 12);
            const newMonthOnly = newMonth % 12;
            const maxDay = new Date(newYear, newMonthOnly + 1, 0).getDate();
            const day = Math.min(d.getDate(), maxDay);
            return new Date(newYear, newMonthOnly, day);
        }

        // Format date to DD/MM/YYYY
        function formatDate(dateString) {
            if (!dateString) return '';
            const date = new Date(dateString);
            const day = date.getDate().toString().padStart(2, '0');
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
        }

        // Find current index in pay matrix
        function findCurrentIndex(level, basicPay) {
            const pays = payMatrix[level];
            if (!pays) return -1;
            
            for (let i = 0; i < pays.length; i++) {
                if (pays[i] === basicPay) {
                    return i;
                }
            }
            return -1;
        }

        // Find exact pay or next higher pay in the matrix
        function findExactOrNextHigherPay(level, calculatedPay) {
            const pays = payMatrix[level];
            if (!pays) return { finalPay: calculatedPay, index: 0 };
            
            for (let i = 0; i < pays.length; i++) {
                if (pays[i] === calculatedPay) {
                    return { finalPay: pays[i], index: i + 1 };
                }
            }
            
            for (let i = 0; i < pays.length; i++) {
                if (pays[i] > calculatedPay) {
                    return { finalPay: pays[i], index: i + 1 };
                }
            }
            
            return { finalPay: pays[pays.length - 1], index: pays.length };
        }

        // Find next higher pay in the matrix (strictly higher)
        function findNextHigherPay(level, calculatedPay) {
            const pays = payMatrix[level];
            if (!pays) return { finalPay: calculatedPay, index: 0 };
            
            for (let i = 0; i < pays.length; i++) {
                if (pays[i] > calculatedPay) {
                    return { finalPay: pays[i], index: i + 1 };
                }
            }
            return { finalPay: pays[pays.length - 1], index: pays.length };
        }

        // ✅ FIXED: Now correctly considers Jan 1 as a candidate
        function getNextIncrementDateAfterSixMonths(fixationDate) {
            const minDate = addMonths(new Date(fixationDate), 6);
            const year = minDate.getFullYear();
            const candidates = [
                new Date(year, 0, 1),     // Jan 1
                new Date(year, 6, 1),     // July 1
                new Date(year + 1, 0, 1)  // Next Jan 1 (safety)
            ];
            for (const cand of candidates) {
                if (cand >= minDate) {
                    return cand;
                }
            }
            return new Date(year + 1, 0, 1);
        }

        function getNextIncrementDate(fixationDate) {
            return getNextIncrementDateAfterSixMonths(fixationDate);
        }

        // Validate increment date
        function isValidIncrementDate(date) {
            const inputDate = new Date(date);
            const day = inputDate.getDate();
            const month = inputDate.getMonth();
            return (day === 1 && (month === 0 || month === 6));
        }

        // Hide all error messages
        function hideAllErrors() {
            document.querySelectorAll('.error-message').forEach(el => {
                el.style.display = 'none';
            });
        }

        // Generate comparison table
        function generateComparisonTable(data) {
            const {
                presentBasicPay, presentLevel, promotedLevel, currentIndex,
                option1Data, option2Data, recommendationData
            } = data;

            const tableHTML = `
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Description</th>
                            <th>Option 1<br>(From Promotion Date)</th>
                            <th>Option 2<br>(From Increment Date)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="date-cell">${formatDate(data.promotionDate)}</td>
                            <td>Present Basic Pay (Level ${presentLevel})</td>
                            <td class="option-1-cell amount-cell">₹${presentBasicPay.toLocaleString()}</td>
                            <td class="option-2-cell amount-cell">₹${presentBasicPay.toLocaleString()}</td>
                        </tr>
                        <tr>
                            <td class="date-cell">${formatDate(data.promotionDate)}</td>
                            <td>One increment in present level</td>
                            <td class="option-1-cell amount-cell">₹${option1Data.incrementedPayInPresentLevel.toLocaleString()}</td>
                            <td class="option-2-cell">-</td>
                        </tr>
                        <tr>
                            <td class="date-cell">${formatDate(data.promotionDate)}</td>
                            <td>Fixation in promoted level</td>
                            <td class="option-1-cell amount-cell">₹${option1Data.finalPay.toLocaleString()}<br>(Index: ${option1Data.index})</td>
                            <td class="option-2-cell amount-cell">₹${option2Data.interimPay.toLocaleString()}<br>(Index: ${option2Data.interimIndex})</td>
                        </tr>
                        <tr>
                            <td class="date-cell">${formatDate(data.nextIncrementDate)}</td>
                            <td>Two increments in present level</td>
                            <td class="option-1-cell">-</td>
                            <td class="option-2-cell amount-cell">₹${option2Data.fictionalPayInLowerLevel.toLocaleString()}</td>
                        </tr>
                        <tr>
                            <td class="date-cell">${formatDate(data.nextIncrementDate)}</td>
                            <td>Re-fixation in promoted level</td>
                            <td class="option-1-cell">-</td>
                            <td class="option-2-cell amount-cell">₹${option2Data.finalPay.toLocaleString()}<br>(Index: ${option2Data.finalIndex})</td>
                        </tr>
                        <tr>
                            <td>-</td>
                            <td>Next Increment Date</td>
                            <td class="option-1-cell">${formatDate(option1Data.nextIncrementDate)}</td>
                            <td class="option-2-cell">${formatDate(option2Data.option2NextIncrementDate)}</td>
                        </tr>
                        <tr>
                            <td>-</td>
                            <td>Pay on Next Increment</td>
                            <td class="option-1-cell amount-cell">₹${option1Data.nextIncrementPay.toLocaleString()}<br>(Index: ${option1Data.nextIncrementIndex})</td>
                            <td class="option-2-cell amount-cell">₹${option2Data.nextIncrementPay.toLocaleString()}<br>(Index: ${option2Data.nextIncrementIndex})</td>
                        </tr>
                        <tr class="recommendation-row">
                            <td colspan="2">Recommended Option</td>
                            <td class="option-1-cell highlight-cell">${recommendationData.recommendedOption === 'Option 1' ? '✓ Recommended' : ''}</td>
                            <td class="option-2-cell highlight-cell">${recommendationData.recommendedOption === 'Option 2' ? '✓ Recommended' : ''}</td>
                        </tr>
                    </tbody>
                </table>
            `;

            resultsContainer.innerHTML = tableHTML;
        }

        // Calculate pay fixation
        function calculateFixation() {
            hideAllErrors();
            
            const presentBasicPay = parseInt(presentBasicPayInput.value);
            const presentLevel = presentLevelSelect.value;
            const promotedLevel = promotedLevelSelect.value;
            const promotionDate = promotionDateInput.value;
            const nextIncrementDate = nextIncrementDateInput.value;
            
            // Validate inputs
            let hasError = false;
            if (!presentBasicPay || presentBasicPay <= 0) {
                document.getElementById('basicPayError').style.display = 'block';
                hasError = true;
            }
            if (!presentLevel) {
                document.getElementById('presentLevelError').style.display = 'block';
                hasError = true;
            }
            if (!promotedLevel) {
                document.getElementById('promotedLevelError').style.display = 'block';
                hasError = true;
            }
            if (!promotionDate) {
                document.getElementById('promotionDateError').style.display = 'block';
                hasError = true;
            }
            if (!nextIncrementDate || !isValidIncrementDate(nextIncrementDate)) {
                document.getElementById('incrementDateError').style.display = 'block';
                hasError = true;
            }
            if (hasError) return;

            // Find current position
            const currentIndex = findCurrentIndex(presentLevel, presentBasicPay);
            if (currentIndex === -1) {
                alert("Invalid basic pay for the selected level");
                return;
            }

            const presentPays = payMatrix[presentLevel];
            const promotedPays = payMatrix[promotedLevel];

            // OPTION 1: Fixation from date of promotion
            let incrementedPayInPresentLevel;
            if (currentIndex < presentPays.length - 1) {
                incrementedPayInPresentLevel = presentPays[currentIndex + 1];
            } else {
                incrementedPayInPresentLevel = presentBasicPay;
            }
            
            const option1Result = findExactOrNextHigherPay(promotedLevel, incrementedPayInPresentLevel);
            const option1NextIncrementDate = getNextIncrementDateAfterSixMonths(promotionDate);
            const option1NextIncrementResult = findNextHigherPay(promotedLevel, option1Result.finalPay + 1);

            // OPTION 2: Fixation from date of increment
            const option2InterimResult = findNextHigherPay(promotedLevel, presentBasicPay);
            
            let fictionalPayInLowerLevel;
            if (currentIndex < presentPays.length - 2) {
                fictionalPayInLowerLevel = presentPays[currentIndex + 2];
            } else {
                fictionalPayInLowerLevel = presentPays[presentPays.length - 1];
            }
            
            const option2FinalResult = findExactOrNextHigherPay(promotedLevel, fictionalPayInLowerLevel);
            const option2NextIncrementDate = getNextIncrementDate(nextIncrementDate);
            const option2NextIncrementResult = findNextHigherPay(promotedLevel, option2FinalResult.finalPay + 1);

            // Prepare data for table
            const tableData = {
                presentBasicPay,
                presentLevel,
                promotedLevel,
                currentIndex,
                promotionDate,
                nextIncrementDate,
                option1Data: {
                    incrementedPayInPresentLevel,
                    finalPay: option1Result.finalPay,
                    index: option1Result.index,
                    nextIncrementDate: option1NextIncrementDate,
                    nextIncrementPay: option1NextIncrementResult.finalPay,
                    nextIncrementIndex: option1NextIncrementResult.index
                },
                option2Data: {
                    interimPay: option2InterimResult.finalPay,
                    interimIndex: option2InterimResult.index,
                    fictionalPayInLowerLevel,
                    finalPay: option2FinalResult.finalPay,
                    finalIndex: option2FinalResult.index,
                    option2NextIncrementDate,
                    nextIncrementPay: option2NextIncrementResult.finalPay,
                    nextIncrementIndex: option2NextIncrementResult.index
                },
                recommendationData: {
                    recommendedOption: option1Result.finalPay > option2FinalResult.finalPay ? 'Option 1' : 
                                    option2FinalResult.finalPay > option1Result.finalPay ? 'Option 2' : 'Either',
                    benefitAmount: Math.abs(option1Result.finalPay - option2FinalResult.finalPay)
                }
            };

            generateComparisonTable(tableData);
        }
    </script>
</body>
</html>
